expression 'DataSourcesByDatasetId - BetMGM' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"6c3250c1-cd1a-4bb8-acb7-0518bc2c8151" = Workspaces{[workspaceId="6c3250c1-cd1a-4bb8-acb7-0518bc2c8151"]}[Data],
		    #"b291c479-c34d-4060-984c-5ad4971bb432" = #"6c3250c1-cd1a-4bb8-acb7-0518bc2c8151"{[dataflowId="b291c479-c34d-4060-984c-5ad4971bb432"]}[Data],
		    #"DataSourcesByDatasetId - BetMGM_" = #"b291c479-c34d-4060-984c-5ad4971bb432"{[entity="DataSourcesByDatasetId - BetMGM",version=""]}[Data]
		in
		    #"DataSourcesByDatasetId - BetMGM_"
	lineageTag: 84791317-cced-4934-a638-840cc6d71e5f
	queryGroup: 'Not Loading'

	annotation PBI_NavigationStepName = Navigation

expression 'DataSourcesByDatasetId - Digital' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"6c3250c1-cd1a-4bb8-acb7-0518bc2c8151" = Workspaces{[workspaceId="6c3250c1-cd1a-4bb8-acb7-0518bc2c8151"]}[Data],
		    #"224c0219-03f3-49a2-a365-683f16de69ae" = #"6c3250c1-cd1a-4bb8-acb7-0518bc2c8151"{[dataflowId="224c0219-03f3-49a2-a365-683f16de69ae"]}[Data],
		    #"DataSourcesByDatasetId - Digital_" = #"224c0219-03f3-49a2-a365-683f16de69ae"{[entity="DataSourcesByDatasetId - Digital",version=""]}[Data]
		in
		    #"DataSourcesByDatasetId - Digital_"
	lineageTag: c2456a95-c8b9-4eed-954d-410f3ed7c23e
	queryGroup: 'Not Loading'

expression 'DataSourcesByDatasetId - Retail' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"6c3250c1-cd1a-4bb8-acb7-0518bc2c8151" = Workspaces{[workspaceId="6c3250c1-cd1a-4bb8-acb7-0518bc2c8151"]}[Data],
		    #"1b5bcb55-648e-4848-a432-1d581f38627a" = #"6c3250c1-cd1a-4bb8-acb7-0518bc2c8151"{[dataflowId="1b5bcb55-648e-4848-a432-1d581f38627a"]}[Data],
		    #"DataSourcesByDatasetId - Retail_" = #"1b5bcb55-648e-4848-a432-1d581f38627a"{[entity="DataSourcesByDatasetId - Retail",version=""]}[Data]
		in
		    #"DataSourcesByDatasetId - Retail_"
	lineageTag: 61050744-515c-4c5f-9a29-2f72cbfb505e
	queryGroup: 'Not Loading'

expression 'DataSourcesByDatasetId - Retail 2' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"6c3250c1-cd1a-4bb8-acb7-0518bc2c8151" = Workspaces{[workspaceId="6c3250c1-cd1a-4bb8-acb7-0518bc2c8151"]}[Data],
		    #"3409e2bc-b2cd-42bd-93be-fc53928b4cc7" = #"6c3250c1-cd1a-4bb8-acb7-0518bc2c8151"{[dataflowId="3409e2bc-b2cd-42bd-93be-fc53928b4cc7"]}[Data],
		    #"DataSourcesByDatasetId - Retail 2_" = #"3409e2bc-b2cd-42bd-93be-fc53928b4cc7"{[entity="DataSourcesByDatasetId - Retail 2",version=""]}[Data]
		in
		    #"DataSourcesByDatasetId - Retail 2_"
	lineageTag: a5302097-bea0-4939-96d5-5c84f0a19936
	queryGroup: 'Not Loading'

	annotation PBI_NavigationStepName = Navigation

expression StartDate =
		let
		 Source = Value.NativeQuery(Snowflake.Databases(Server,Warehouse,[Role=Role]){[Name=Database]}[Data], "select year(current_date - interval '2 years')*10000 + month(current_date)*100 + 01", null, [EnableFolding=true]),
		    #"Renamed Columns" = Table.RenameColumns(Source,{{"YEAR(CURRENT_DATE - INTERVAL '2 YEARS')*10000 + MONTH(CURRENT_DATE)*100 + 01", "_col0"}}),
		    _col0 = #"Renamed Columns"{0}[_col0]
		in
		    _col0
	lineageTag: 84e9f236-2f1a-4b16-8de0-47828906251c

	annotation PBI_ResultType = Number

	annotation PBI_NavigationStepName = Navigation

expression EndDate =
		let
		    Source = Value.NativeQuery(Snowflake.Databases(Server,Warehouse,[Role=Role]){[Name=Database]}[Data], "select current_date", null, [EnableFolding=true]),
		    #"Renamed Columns" = Table.RenameColumns(Source,{{"CURRENT_DATE", "_col0"}}),
		    _col0 = #"Renamed Columns"{0}[_col0]
		in
		    _col0
	lineageTag: 4f61edc6-5c3a-4305-843b-bba20c656dc3

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Date

expression pbi_activityevents_Views =
		let
		    Source = Value.NativeQuery(Snowflake.Databases(Server,Warehouse,[Role=Role]){[Name=Database]}[Data], "select #(lf)#(tab)distinct#(lf)        p.datasetid, p.datasetname,p.reportid,p.reportname #(lf)     ,count(case when p.activity = 'ViewReport' then 1 end) as Views#(lf)#(tab),count(case when datediff('day',TO_DATE(SUBSTR(creationtime,1,10)),current_date)<=90 and p.activity='ViewReport' then 1 end) as Views_90days#(lf)#(tab),count(case when datediff('day',TO_DATE(SUBSTR(creationtime,1,10)),current_date)<=60 and p.activity='ViewReport'  then 1 end) as Views_60days#(lf)#(tab),count(case when datediff('day',TO_DATE(SUBSTR(creationtime,1,10)),current_date)<=30 and p.activity='ViewReport'  then 1 end) as Views_30days#(lf)#(tab),count(case when p.activity = 'ExportReport' then 1 end) as Downloads#(lf)#(tab),count(case when datediff('day',TO_DATE(SUBSTR(creationtime,1,10)),current_date)<=90 and p.activity='ExportReport' then 1 end) as Downloads_90days#(lf)#(tab),count(case when datediff('day',TO_DATE(SUBSTR(creationtime,1,10)),current_date)<=60 and p.activity='ExportReport'  then 1 end) as Downloads_60days#(lf)#(tab),count(case when datediff('day',TO_DATE(SUBSTR(creationtime,1,10)),current_date)<=30 and p.activity='ExportReport'  then 1 end) as Downloads_30days#(lf)#(tab),count(case when p.activity = 'AnalyzeInExcel' then 1 end) as AnalyzeInExcel#(lf)from #(lf)#(tab)EDLRETAILVIEWSBI.pbi_activityevents p#(lf)where #(lf)  (p.capacityid <> '' and p.capacityid is NOT NULL)#(lf)#(tab)group by p.datasetid,p.datasetname,p.reportid,p.reportname", null, [EnableFolding=true]),
		    #"Renamed Columns" = Table.RenameColumns(Source,{{"DATASETID", "datasetid"}, {"DATASETNAME", "datasetname"}, {"REPORTID", "reportid"}, {"REPORTNAME", "reportname"}, {"VIEWS", "Views"}, {"VIEWS_90DAYS", "Views_90days"}, {"VIEWS_60DAYS", "Views_60days"}, {"VIEWS_30DAYS", "Views_30days"}, {"DOWNLOADS", "Downloads"}, {"DOWNLOADS_90DAYS", "Downloads_90days"}, {"DOWNLOADS_60DAYS", "Downloads_60days"}, {"DOWNLOADS_30DAYS", "Downloads_30days"}, {"ANALYZEINEXCEL", "AnalyzeInExcel"}})
		in
		    #"Renamed Columns"
	lineageTag: d35d47ce-98e0-4fc0-b4df-20e7c7228a24

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression RelationCapacityGroupsReports =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"b1189a55-d3ea-4ceb-8dd9-994de230fca3" = Workspaces{[workspaceId="b1189a55-d3ea-4ceb-8dd9-994de230fca3"]}[Data],
		    #"72d38d67-1c11-412c-98df-4ebbd50bcc7b" = #"b1189a55-d3ea-4ceb-8dd9-994de230fca3"{[dataflowId="72d38d67-1c11-412c-98df-4ebbd50bcc7b"]}[Data],
		    RelationCapacityGroupsReports = #"72d38d67-1c11-412c-98df-4ebbd50bcc7b"{[entity="RelationCapacityGroupsReports",version=""]}[Data],
		    #"Removed Other Columns" = Table.SelectColumns(RelationCapacityGroupsReports,{"isReadOnly", "ReportId", "DatasetId"}),
		    #"Removed Columns" = Table.RemoveColumns(#"Removed Other Columns",{"isReadOnly"}),
		    #"Lowercased Text" = Table.TransformColumns(#"Removed Columns",{{"ReportId", Text.Lower, type text}})
		in
		    #"Lowercased Text"
	lineageTag: b8a7ab71-9f81-421c-a43c-67db85e00e00

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression RelationCapacityGroupsReportsDatasets =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"b1189a55-d3ea-4ceb-8dd9-994de230fca3" = Workspaces{[workspaceId="b1189a55-d3ea-4ceb-8dd9-994de230fca3"]}[Data],
		    #"72d38d67-1c11-412c-98df-4ebbd50bcc7b" = #"b1189a55-d3ea-4ceb-8dd9-994de230fca3"{[dataflowId="72d38d67-1c11-412c-98df-4ebbd50bcc7b"]}[Data],
		    RelationCapacityGroupsReports = #"72d38d67-1c11-412c-98df-4ebbd50bcc7b"{[entity="RelationCapacityGroupsReports",version=""]}[Data],
		    #"Lowercased Text" = Table.TransformColumns(RelationCapacityGroupsReports,{{"ReportId", Text.Lower, type text}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Lowercased Text",{"isReadOnly", "CapacityId", "CapacityNameOfReport", "GroupId", "GroupName", "ReportId", "ReportName"}),
		    #"Removed Duplicates" = Table.Distinct(#"Removed Other Columns", {"ReportId"}),
		    #"Removed Columns" = Table.RemoveColumns(#"Removed Duplicates",{"isReadOnly"})
		in
		    #"Removed Columns"
	lineageTag: ae908757-bc16-434f-be8a-4f63631256da

	annotation PBI_ResultType = Table

expression RelationCapacityGroupsDatasets =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"b1189a55-d3ea-4ceb-8dd9-994de230fca3" = Workspaces{[workspaceId="b1189a55-d3ea-4ceb-8dd9-994de230fca3"]}[Data],
		    #"72d38d67-1c11-412c-98df-4ebbd50bcc7b" = #"b1189a55-d3ea-4ceb-8dd9-994de230fca3"{[dataflowId="72d38d67-1c11-412c-98df-4ebbd50bcc7b"]}[Data],
		    RelationCapacityGroupsDatasets = #"72d38d67-1c11-412c-98df-4ebbd50bcc7b"{[entity="RelationCapacityGroupsDatasets",version=""]}[Data],
		    #"Removed Other Columns" = Table.SelectColumns(RelationCapacityGroupsDatasets,{"CapacityId", "CapacityName", "GroupId", "GroupName", "DatasetId", "DatasetName"}),
		    #"Filtered Rows" = Table.SelectRows(#"Removed Other Columns", each ([DatasetId] <> "")),
		    #"Removed Duplicates" = Table.Distinct(#"Filtered Rows", {"DatasetId"})
		in
		    #"Removed Duplicates"
	lineageTag: 07c8b08b-dac4-4050-a1b7-d6b7ff4ec113

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'DataSourcesByDatasetId - Dev Digital_Retail' =
		let
		    Source = PowerPlatform.Dataflows(null),
		    Workspaces = Source{[Id="Workspaces"]}[Data],
		    #"6c3250c1-cd1a-4bb8-acb7-0518bc2c8151" = Workspaces{[workspaceId="6c3250c1-cd1a-4bb8-acb7-0518bc2c8151"]}[Data],
		    #"b291c479-c34d-4060-984c-5ad4971bb432" = #"6c3250c1-cd1a-4bb8-acb7-0518bc2c8151"{[dataflowId="4e78bfa8-0547-430b-8daf-bebdd8743119"]}[Data],
		    #"DataSourcesByDatasetId - BetMGM_" = #"b291c479-c34d-4060-984c-5ad4971bb432"{[entity="DataSourcesByDatasetId - Digital",version=""]}[Data]
		in
		    #"DataSourcesByDatasetId - BetMGM_"
	lineageTag: 1e5d6ff8-1dd4-4c59-aa78-51d5e1b37172
	queryGroup: 'Not Loading'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression Server = "entaindataplatform.eu-west-1.snowflakecomputing.com" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = "Text"]
	lineageTag: 2ada685a-b30a-4043-a2bc-63c01dcfcda8
	queryGroup: Parameters

	annotation PBI_ResultType = Text

expression Warehouse = "WH_RTL_SUMM_PBI" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = "Text"]
	lineageTag: 411a7418-6203-466b-9388-8b5dfd16c52c
	queryGroup: Parameters

	annotation PBI_ResultType = Text

	annotation PBI_NavigationStepName = Navigation

expression Role = "RL_RETAIL_PRODRPT_VH_R" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = "Text"]
	lineageTag: 8b6e5ad0-2296-4bfc-8d58-8a396317f62f
	queryGroup: Parameters

	annotation PBI_ResultType = Text

	annotation PBI_NavigationStepName = Navigation

expression Database = "EDLRETAILVIEWS" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = "Text"]
	lineageTag: 0ce0cac2-a963-4276-a73a-6191a19c9bc7
	queryGroup: Parameters

	annotation PBI_ResultType = Text

